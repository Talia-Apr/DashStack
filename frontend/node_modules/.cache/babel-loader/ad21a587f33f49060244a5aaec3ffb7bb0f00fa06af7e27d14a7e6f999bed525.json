{"ast":null,"code":"import axios from \"axios\";\nimport { jwtDecode } from \"jwt-decode\";\nconst checkAuth = async () => {\n  try {\n    const response = await axiosJWT.get('http://localhost:5000/token');\n    setToken(response.data.accessToken);\n    const decoded = jwtDecode(response.data.accessToken);\n    console.log(decoded);\n  } catch (error) {\n    navigate('/login'); // Arahkan ke halaman login jika terjadi kesalahan\n  }\n  const PUBLIC_ROUTES = [\"login\", \"forgot-password\", \"register\", \"documentation\"];\n  const isPublicPage = PUBLIC_ROUTES.some(r => window.location.href.includes(r));\n  if (!accessToken && !isPublicPage) {\n    window.location.href = '/login';\n    return false;\n  } else {\n    axios.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;\n\n    // Cek validitas session dengan memanggil endpoint Me\n    try {\n      const response = await axios.get('/api/me'); // Sesuaikan endpoint dengan yang Anda miliki\n      // Jika berhasil, berarti session masih valid\n      return accessToken;\n    } catch (error) {\n      // Jika terjadi error (misalnya 401), redirect ke login\n      if (error.response && error.response.status === 401) {\n        window.location.href = '/login';\n      }\n      return false;\n    }\n  }\n};\nexport default checkAuth;","map":{"version":3,"names":["axios","jwtDecode","checkAuth","response","axiosJWT","get","setToken","data","accessToken","decoded","console","log","error","navigate","PUBLIC_ROUTES","isPublicPage","some","r","window","location","href","includes","defaults","headers","common","status"],"sources":["C:/xampp/htdocs/DashStack/frontend/src/app/auth.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { jwtDecode } from \"jwt-decode\"\r\n\r\nconst checkAuth = async () => {\r\n \r\n        try {\r\n            const response = await axiosJWT.get('http://localhost:5000/token');\r\n            setToken(response.data.accessToken);\r\n            const decoded = jwtDecode(response.data.accessToken);\r\n            console.log(decoded);\r\n        } catch (error) {\r\n            navigate('/login'); // Arahkan ke halaman login jika terjadi kesalahan\r\n        }\r\n\r\n    const PUBLIC_ROUTES = [\"login\", \"forgot-password\", \"register\", \"documentation\"];\r\n    const isPublicPage = PUBLIC_ROUTES.some(r => window.location.href.includes(r));\r\n\r\n    if (!accessToken && !isPublicPage) {\r\n        window.location.href = '/login';\r\n        return false;\r\n    } else {\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;\r\n\r\n        // Cek validitas session dengan memanggil endpoint Me\r\n        try {\r\n            const response = await axios.get('/api/me'); // Sesuaikan endpoint dengan yang Anda miliki\r\n            // Jika berhasil, berarti session masih valid\r\n            return accessToken;\r\n        } catch (error) {\r\n            // Jika terjadi error (misalnya 401), redirect ke login\r\n            if (error.response && error.response.status === 401) {\r\n                window.location.href = '/login';\r\n            }\r\n            return false;\r\n        }\r\n        \r\n    }\r\n};\r\n\r\nexport default checkAuth;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;AAEtC,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;EAEtB,IAAI;IACA,MAAMC,QAAQ,GAAG,MAAMC,QAAQ,CAACC,GAAG,CAAC,6BAA6B,CAAC;IAClEC,QAAQ,CAACH,QAAQ,CAACI,IAAI,CAACC,WAAW,CAAC;IACnC,MAAMC,OAAO,GAAGR,SAAS,CAACE,QAAQ,CAACI,IAAI,CAACC,WAAW,CAAC;IACpDE,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;EACxB,CAAC,CAAC,OAAOG,KAAK,EAAE;IACZC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;EACxB;EAEJ,MAAMC,aAAa,GAAG,CAAC,OAAO,EAAE,iBAAiB,EAAE,UAAU,EAAE,eAAe,CAAC;EAC/E,MAAMC,YAAY,GAAGD,aAAa,CAACE,IAAI,CAACC,CAAC,IAAIC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAACJ,CAAC,CAAC,CAAC;EAE9E,IAAI,CAACT,WAAW,IAAI,CAACO,YAAY,EAAE;IAC/BG,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IAC/B,OAAO,KAAK;EAChB,CAAC,MAAM;IACHpB,KAAK,CAACsB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUhB,WAAW,EAAE;;IAExE;IACA,IAAI;MACA,MAAML,QAAQ,GAAG,MAAMH,KAAK,CAACK,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;MAC7C;MACA,OAAOG,WAAW;IACtB,CAAC,CAAC,OAAOI,KAAK,EAAE;MACZ;MACA,IAAIA,KAAK,CAACT,QAAQ,IAAIS,KAAK,CAACT,QAAQ,CAACsB,MAAM,KAAK,GAAG,EAAE;QACjDP,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MACnC;MACA,OAAO,KAAK;IAChB;EAEJ;AACJ,CAAC;AAED,eAAelB,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}