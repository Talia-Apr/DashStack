{"ast":null,"code":"import axios from \"axios\";\nconst checkAuth = async () => {\n  try {\n    const response = await axiosJWT.get('http://localhost:5000/token');\n    setToken(response.data.accessToken);\n    const decoded = jwtDecode(response.data.accessToken);\n    console.log(decoded);\n    setName(decoded.name);\n    setEmail(decoded.email);\n    setExpire(decoded.exp);\n  } catch (error) {\n    navigate('/login'); // Arahkan ke halaman login jika terjadi kesalahan\n  }\n  const PUBLIC_ROUTES = [\"login\", \"forgot-password\", \"register\", \"documentation\"];\n  const isPublicPage = PUBLIC_ROUTES.some(r => window.location.href.includes(r));\n  if (!token && !isPublicPage) {\n    window.location.href = '/login';\n    return false;\n  } else {\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n    // Cek validitas session dengan memanggil endpoint Me\n    try {\n      const response = await axios.get('/api/me'); // Sesuaikan endpoint dengan yang Anda miliki\n      // Jika berhasil, berarti session masih valid\n      return token;\n    } catch (error) {\n      // Jika terjadi error (misalnya 401), redirect ke login\n      if (error.response && error.response.status === 401) {\n        window.location.href = '/login';\n      }\n      return false;\n    }\n  }\n};\nexport default checkAuth;","map":{"version":3,"names":["axios","checkAuth","response","axiosJWT","get","setToken","data","accessToken","decoded","jwtDecode","console","log","setName","name","setEmail","email","setExpire","exp","error","navigate","PUBLIC_ROUTES","isPublicPage","some","r","window","location","href","includes","token","defaults","headers","common","status"],"sources":["C:/xampp/htdocs/DashStack/frontend/src/app/auth.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst checkAuth = async () => {\r\n \r\n        try {\r\n            const response = await axiosJWT.get('http://localhost:5000/token');\r\n            setToken(response.data.accessToken);\r\n            const decoded = jwtDecode(response.data.accessToken);\r\n            console.log(decoded);\r\n            setName(decoded.name);\r\n            setEmail(decoded.email);\r\n            setExpire(decoded.exp);\r\n        } catch (error) {\r\n            navigate('/login'); // Arahkan ke halaman login jika terjadi kesalahan\r\n        }\r\n\r\n    const PUBLIC_ROUTES = [\"login\", \"forgot-password\", \"register\", \"documentation\"];\r\n    const isPublicPage = PUBLIC_ROUTES.some(r => window.location.href.includes(r));\r\n\r\n    if (!token && !isPublicPage) {\r\n        window.location.href = '/login';\r\n        return false;\r\n    } else {\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n\r\n        // Cek validitas session dengan memanggil endpoint Me\r\n        try {\r\n            const response = await axios.get('/api/me'); // Sesuaikan endpoint dengan yang Anda miliki\r\n            // Jika berhasil, berarti session masih valid\r\n            return token;\r\n        } catch (error) {\r\n            // Jika terjadi error (misalnya 401), redirect ke login\r\n            if (error.response && error.response.status === 401) {\r\n                window.location.href = '/login';\r\n            }\r\n            return false;\r\n        }\r\n        \r\n    }\r\n};\r\n\r\nexport default checkAuth;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;EAEtB,IAAI;IACA,MAAMC,QAAQ,GAAG,MAAMC,QAAQ,CAACC,GAAG,CAAC,6BAA6B,CAAC;IAClEC,QAAQ,CAACH,QAAQ,CAACI,IAAI,CAACC,WAAW,CAAC;IACnC,MAAMC,OAAO,GAAGC,SAAS,CAACP,QAAQ,CAACI,IAAI,CAACC,WAAW,CAAC;IACpDG,OAAO,CAACC,GAAG,CAACH,OAAO,CAAC;IACpBI,OAAO,CAACJ,OAAO,CAACK,IAAI,CAAC;IACrBC,QAAQ,CAACN,OAAO,CAACO,KAAK,CAAC;IACvBC,SAAS,CAACR,OAAO,CAACS,GAAG,CAAC;EAC1B,CAAC,CAAC,OAAOC,KAAK,EAAE;IACZC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;EACxB;EAEJ,MAAMC,aAAa,GAAG,CAAC,OAAO,EAAE,iBAAiB,EAAE,UAAU,EAAE,eAAe,CAAC;EAC/E,MAAMC,YAAY,GAAGD,aAAa,CAACE,IAAI,CAACC,CAAC,IAAIC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAACJ,CAAC,CAAC,CAAC;EAE9E,IAAI,CAACK,KAAK,IAAI,CAACP,YAAY,EAAE;IACzBG,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IAC/B,OAAO,KAAK;EAChB,CAAC,MAAM;IACH1B,KAAK,CAAC6B,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;;IAElE;IACA,IAAI;MACA,MAAM1B,QAAQ,GAAG,MAAMF,KAAK,CAACI,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;MAC7C;MACA,OAAOwB,KAAK;IAChB,CAAC,CAAC,OAAOV,KAAK,EAAE;MACZ;MACA,IAAIA,KAAK,CAAChB,QAAQ,IAAIgB,KAAK,CAAChB,QAAQ,CAAC8B,MAAM,KAAK,GAAG,EAAE;QACjDR,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MACnC;MACA,OAAO,KAAK;IAChB;EAEJ;AACJ,CAAC;AAED,eAAezB,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}